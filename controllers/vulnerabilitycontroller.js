const model = require("../model/vulnerabilitymodel.js")

//INSERTING NEW VULNERABILITY 

module.exports.createNewVulnerability = (req, res, next) => {
    const data = {
        type: req.body.type,
        description: req.body.description,
        points: req.body.points,
    };


    model.insertvulnerability(data, (error, results) => {
        if (error) {
            console.log("There was an error adding a vulnerability", error);
            res.status(500).json(error);
        } else {
            res.status(201).json({ id: results.insertId });
        }
    });
};


module.exports.getAllVulnerabilities = (req, res, next) => {
    const callback = (error,results) => {
        if(error) {
            res.status(500).send("Error: There was an error retrieving all vulnerabilities")
            return;
        } else {
            res.status(200).json(results)
        }
    }

    model.selectAllVulnerabilities(callback)

}